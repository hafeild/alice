<% provide(:title, "#{@query} -- #{@vertical} search results") %>
<div class="container serp">
  <h1>Search results</h1>
  
  
  <!-- Verticals that can be searched. CSS will take care of showing which
       was searched on the current SERP. -->
  <div class="search-verticals serp-for-<%= @vertical %>">
    <span data-vertical="all" class="all vertical-tab">All verticals</span>
    <span data-vertical="assignments" 
      class="assignments vertical-tab">Assignments</span>
    <span data-vertical="analyses" class="analyses vertical-tab">Analyses</span>
    <span data-vertical="software" class="software vertical-tab">Software</span>
    <span data-vertical="datasets" class="datasets vertical-tab">Datasets</span>
  </div>
  
  <form id="search-box-form" action="/search/<%= @vertical %>">
    <div class="input-group">
      <input type="text" class="form-control" placeholder="Search"
        name="q" value="<%= @query %>">
      <div class="input-group-btn">
        <button class="btn btn-default" type="submit">
          <i class="glyphicon glyphicon-search"></i>
        </button>
       </div>
    </div>
  </form>
  

  
  <% if @search.results.size == 0 %>
  
  <p class="no-results">
    Oh no! No results were found for your search. Please try a different query.
  </p>
  
  <% else %>
  
  <p>
  Showing search results for <strong><%= @query %></strong>.
  Found <%= @search.total %> results in <%= @query_seconds.round(3) %> seconds.
  </p>
  
  <ul class="results">
    <%= render partial: 'result_set', locals: {search: @search} %>
  </ul>

  <div class="infinite-scroll" 
    data-next-page-cursor="<%= @search.results.next_page_cursor %>"
    data-vertical="<%= @vertical %>"
    data-query="<%= @query %>">
    
    <div class="click-for-more-results">
      <button class="btn btn-default-sm">Click to see more results</button>
    </div>
    <div class="message loading-more-results hidden">
      Loading more results...
    </div>
    <div class="message no-more-results 
      <%= @search.results.last_page? ? "" : "hidden" %>">
      There are no more results to load.
    </div>
    <div class="message error hidden">
      There was an error retrieving more results.
    </div>
  </div>
  <% end %>
</div>